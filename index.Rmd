---
title: "R Packages"
subtitle: "Or, The Best Way to Distribute Anything Ever"  
author: "Nick Solomon | New York City Council"
date: 'October 19, 2018'
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r xaringan-themer, include=FALSE}
library(xaringanthemer)

mono_light(
  base_color = "#2f56a6",
  white_color = "#FFFFFF",
  black_color = "#000000",
  text_font_size = "28px",
  text_font_google = google_font("Lato", "400", "400i", "700", "700i"),
  header_font_google = google_font("Roboto Slab"),
  header_color = darken_color("#2f56a6", .3),
  code_inline_color = darken_color("#2f56a6", .4),
  code_highlight_color = "rgba(88, 119, 183, .5)",
  text_slide_number_font_size = ".7em"
)
```

class: center, middle, inverse

# What is an R package?

---

## What is an R package?
--

- Code
--

- Documentation
--

- Data
--

- Vignettes

---

## What is an R package?
--

- `R/`
--

- `man/`
--

- `data/`
--

- `vignettes/`
--

- `DESCRIPTION`
- `NAMESPACE`
- `LICENSE`
- `tests/`
---

## The package paradigm
--

If your project is a package then:
--

- Everything is versioned
--

- Dependencies are explicitly stated
--

  - In a machine readable way
--

- The whole project can easily be shared
--

- You can be almost certain the project is reproducible

---

## When to create an R package?
--

- When you write code that:
--

  - Will be shared
--

  - Will be run more than once
--

  - Will be run by someone else
--

  - Should be well documented
--

- When you have data that:
--

  - Will be shared
--

  - Has been cleaned
--

- When you write reports that:
--

  - Need to be reproducible
--

  - Will be shared

---

## Disadvantages of creating a package
--

- Administrative overhead
--

- A new workflow
--

- Forces best practices `r emo::ji("wink")`

---

# Things that will make your life easier
--

- RStudio
--

- `devtools`
--

- `roxygen2`

---

class: center, middle, inverse

# Code

---

## The `R/` directory
--

- Fill your package with functions
--

- `my_function.R`:

```r
my_function <- function (x, y) {
  return(x+y)
}
```
--

- Put any and all functions here
--

  - Even "private" ones that won't be available to the user of your package

---

## Best practices
--

- Make dependencies explicit with `::`
--

- One (public) function per file
--

---

class: center, middle, inverse

# Documentation

---

## How to write documentation
--

- In RStudio:
--

  - Code > Insert Roxygen Skeleton 
--


```r
#' Title
#'
#' @param x 
#' @param y 
#'
#' @return
#' @export
#'
#' @examples
```
---

## What is Roxygen?
--

- Special comments in your code that documentation is made from
--

- Code and docs live together
--

- When you change one, it's easy to change the other

---

## Default Roxygen tags
--

- `@param`
--

  - Document what the function parameter means
--

- `@return`
--

  - What the function returns
--

- `@export`
--

  - Tell R you want this function to be public
--

- `@examples`
--

  - Include examples of how your function is used
--

  - These will be run (unless you say otherwise)


---

## Other useful Roxygen tags
--

- `@importFrom <package> <function> ...`
--

  - Make functions from packages available without `::`
--

- `@import <package>`
--

  - Make *all* functions from a package available with out `::`

---

## What does Roxygen do?
--

- Run `devtools::document()`
--

- `man/*.Rd`
--

- `NAMESPACE`
--
  
  - Exports and imports

---

## What *doesn't* Roxygen do?
--

- `DESCRIPTION`
--

  - Explicitly state package dependencies
--


```
...
Imports: dplyr,
    ggplot2 (>= 2.1.0),
    rlang
...
```

---

class: center, middle, inverse

# Data

---

class: center, middle, inverse

# Vignettes

---

class: center, middle, inverse

# Resources
